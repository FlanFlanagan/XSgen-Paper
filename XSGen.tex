\documentclass{article}
\begin{document}
\title{XSGen}
\date{January, 25, 2017}
\author{Flanagan, Robert \and Scopatz, Anthony}
\maketitle

\section{Introduction}
As the development and deployment of new nuclear reactor technologies increases, the impacts of these technologies must be fully characterized. One possible avenue for accomplishing this is using fuel cycle simulators capable of representing the physics the occurs inside these reactors. Several simulators exist, but not all can model the physics internal to these reactors. Some that are capable of this level of physics are COSI [citation needed], CLASS [citation needed] and certain modules within Cyclus [citation needed]. 

Bright-lite [citation needed] is a medium fidelity reactor model for Cyclus. It uses a fluence based approached to calculate appropriate discharge fluence, and isotopic vectors for a reactor. To accomplish this, it uses criticality, burnup, and transmutation matrices for each isotope of the reactors input fuel of a given reactor type. This information is generated using one group cross sections and a Bateman Equation solver. The reliance on one group cross sections means that the fidelity of the calculations is only as good as the data, and method, used to generate the one group cross sections. Therefore, improving the physics models used to generate the one group cross sections will improve the fidelity of the results generated by Bright-lite. 

There are several existing techniques for generating the required data for Bright-lite to operate. MCNP[MCNP citication] and Monteburns[citation required] are both software that are capable of producing results that Bright-lite could use, but both have flaws. MCNP is primilary a monte carlo code, it does however, have a fuel burning function (the burn card) within it. Unfortunately it does not provide all of the cross sections and reactions that Bright-lite is interested in. 

Monteburns functions very similar to the burn card currently in MCNP. It extracts cross sections from MCNP and uses those to create one group cross sections for a bateman equation solver, it then simulates burning the fuel. This is the ideal path for producing Bright-lite data, however, Monteburns is lacking in some very important charactistics. First, Monteburns is limited to the reactor types that are included with the software. This is problematic because Bright-lite aims to simulate newer and more advanced reactor types. Therefore, any software for linking into Bright-lite must be flexible in terms of reactor design. Second, Monteburns is not capable of producing multigroup cross sections. While Bright-lite is not capable of yet using multigroup cross sections, that is one goal of the software moving forward.   

XSGen is a new methodology aimed at developing higher accuracy cross sections. Similar to the work flow of Monteburns, it couples a Monte Carlo software with a Bateman Equation solver.  By coupling the two software it is possible to generate fluence dependent values for neutron production, destruction, and transmutation matrices for each isotope as the flux spectrum within a reactor evolves. It provides the capability to investigate any cross section that exists in ENDF, EAF, and ACE cross section databases, to collapse them into single or multigroup cross sections, and to provide the data required by Bright-lite directly. 

\section{XSGen Work Flow}
The XSGen work flow is composed of 3 main parts as mentioned above. The first step is the simulation of the reactor core using a Monte Carlo simulation. The results of this are then taken in by a wrapping software and converted into one group cross sections for a specific reactor. These cross sections are then used inside of the Bateman Equation software to calculation the burnup, neutron production, neutron destruction, and transmutation matrixes. This values are calculated at a user defined time length. The composition of the material at the end of the time step is then returned to the Monte Carlo simulator and the process is repeated. 

\subsection{OpenMC}
The software chosen to perform the Monte Carlo operations was OpenMC [OpenMC citation].  OpenMC was chosen due to its open source nature and ability to quickly perform the calculation required. The only information required from the results of the OpenMC run is the group fluxes. These are used later to calculation one group cross sections. 

Input templates for OpenMC can be added to the XSGen system as need reactor types become available for modeling. 

\subsection{PyNE}
PyNE, or Python for Nuclear Engineering [PyNE citation], is the software used to perform the group collapse. The functionality to perform this group collapse was added to PyNE to facilitate the coupling of these two software. The collapse is performed using the following method. 
The first thing that is computed is a collection of weights used to represent the background cross section for each isotope is created. These weights are important because the allow the system to incorporate self-shielding behavior into the collapsed cross sections. This done using the following equation.

$$\omega_{y,n}=\frac{1}{\frac{(\sum_(X\neq Y)N^x * σ_(t,g)^x}{N^y}+\sigma_{t,g}^y}$$

Here all isotopes in the fuel are included in the set of X, and Y is the isotope in question. NY represents the number density of isotope Y, and \begin{math}\sigma_{t,n}\end{math} represents the total cross section of an isotope in a specific energy bin, n. Therefore \begin{math}\omega\end{math} represents a two-dimensional matrix of X (number of isotopes) by G (number of groups). These weights must be recalculated every time-step. 

Note, that the cross sections used in this calculation must be provided by an outside source. PyNE is capable of reading in cross sections from several different cross section libraries including; ENDF, Cinder, EAF, and OpenMC. In this case the OpenMC cross sections were used. 

Next a partial energy matrix (PEM) is constructed. This maps a higher resolution group structures to lower resolution group structures. For the use case of XSGen this lower group structure is always a one group. 

Insert PEM creation formula

Once the PEM is constructed a collapsed flux is generated. Again, this collapses a detailed group structure into a single group. 

$$\sigma_g = PEM ∙(\sigma*\omega)$$

Here, \begin{math}\phi\end{math} represents the vector of group fluxes, and \begin{math}\phi_g\end{math} is the collapsed flux. With the one group flux it is possible to generate the one group cross sections. 

$$\sigma_{i,g}^x=\frac{[PEM∙(\sigma_i^x*\phi*\omega)]}{\sigma_g} $$

Here $\sigma_{i,g}^x$ represents the one group cross section of specific type i, for isotope x. Once this has been completed for all the chosen isotopes and cross sections they are used to generate a TAPE9 cross section file for that time-step. 

\subsection{Origin2.2}
Once the TAPE9 has been constructed it is used to perform two types of burnup operations. The first burnup is performed on the fuel. This includes the full list of isotopes currently in the fuel. Once this burnup is performed the isotopic vector at the end of the fuel burn is passed back to OpenMC to start the operation all over again.  

The second type of burnup calculation is used to build a dataset for a specific isotope. These burnup runs take one kilogram of a pure isotope as the input fuel. At the end of the run, the burnup, neutron production/destruction, and transmutation matrix are all recorded. The isotopes of interest are chosen ahead of time by the user of the software, typically these are the isotopes that the user wishes to use as the input fuel for the reactor type/design that they are investigating. 

\section{Benchmarking}
\subsection{LWR Test Cases}
XSGen by itself can not directly be tested against operating reactor systems. It was originally designed to produce datasets a medium fidelity reactor model known as Bright-lite. Therefore, to benchmark XSGen it will be used in conjunction with Bright-lite to produce burnups and isotopes for several known reactor systems.  As Bright-lite has already been benchmarked several times using other datasets [BRIGHT-LITE Benchmark Citations] it is assumed that the operations within Bright-lite are accurate and any deviations within the results come from XSGen. 

The most well studied reactors in the world are light water reactors and as such these will be used as benchmarking tools for XSGen. Primarily the cases represent a range of different enrichments in several light water reactors, comparing the results from XSGen/Bright-lite to recipes from VISION. Additionally, the values will be tested against two cases modelling reactor startup behavior.  [vision citation / transition citation].

The XSGen/Bright-light will be benchmarked against VISION at 3.0, 3.5, 4.0, and 4.5 percent enrichment. Three batch cores will be assumed for all the enrichment test cases. 
The two cases being used to test XSGen in startup behavior will be a 3.1$\%$ enriched light water reactor using four batches and a 3.6$\%$ enriched light water reactor using four batches. The cases will be compared using burnups, isotopic composition of fresh and used fuel.

\subsection{Results}
\begin{table}[]
\centering
\caption{A comparison of the output isotopics at equalibrium in the VISION fuel cycle simulator and the XSGen-Bright-lite system.}
\label{Table 1}
\begin{tabular}{llllllllll}
 & \multicolumn{3}{c}{3.0\%} & \multicolumn{3}{c}{3.5\%} & \multicolumn{3}{c}{4.0\%} \\
Isotope & VISION & XSGen-BL & Diff & VISION & XSGen-BL & Diff & VISION & XSGen-BL & Diff \\
U235 & 6.75E-3 & 6.70E-03 & 0.78 & 6.80E-3 & 6.71E-3 & 1.30 & 6.95E-3 & 6.91E-3 & 0.562 \\
Pu238 & 1.23E-4 & 1.27E-4 & -3.01 & 1.85E-4 & 1.86E-4 & 0.41 & 2.52E-4 & 2.55E-4 & -1.35 \\
Pu239 & 5.15E-3 & 5.25E-3 & -1.95 & 5.41E-3 & 5.45E-3 & -0.66 & 5.64E-3 & 5.67E-3 & -0.57 \\
Pu240 & 2.38E-3 & 2.4E-3 & -0.97 & 2.60E-3 & 2.61E-3 & -0.25 & 2.78E-3 & 2.79E-3 & -0.4 \\
Pu241 & 1.30E-3 & 1.35E-3 & -3.69 & 1.48E-3 & 1.52E-3 & -2.74 & 1.62E-3 & 1.62E-3 & 0.02 \\
Pu242 & 5.43E-4 & 5.48E-4 & -0.88 & 6.92E-4 & 6.93E-4 & -0.10 & 8.17E-4 & 8.19E-04 & 0.28
\end{tabular}
\end{table}

@Table 1 shows a very strong agreement between VISION and Bright-light results using datasets created from light water reactors designed to these particular enrichments. Bright-light has been benchmarked [Bright-lite citations] against VISION previously using other datasets. This shows that given XSGen generated datasets allows for Bright-lite to match to within a 5\% tolerance of VISION. These results are an improvement over previous benchmarking attempts with Bright-lite. 

\begin{table}[]
\centering
\caption{NEA core discharge data for a 3.1\% enriched light water reactor with startup behavior.}
\label{Table 2}
\begin{tabular}{lllll}
Batch & Burnup (MWd/kg) & U235 (\%) & Fissile Pu (\%) & Total Pu(\%) \\
1 & 12.04 & 0.64 & 0.464 & 0.633 \\
2 & 23.86 & 0.76 & 0.6 & 0.818 \\
3 & 31.75 & 0.8 & 0.677 & 0.921 \\
4 & 32.00 & 0.85 & 0.697 & 0.943 \\
Equil. & 33.00 & 0.85 & 0.688 & 0.943
\end{tabular}
\end{table}

\begin{table}[]
\centering
\caption{The startup values and percent difference from the NEA data for the XSGen/Bright-lite reactor system.}
\label{Table 3}
\begin{tabular}{lllllllll}
 & \multicolumn{2}{l}{Burnup (MWd/kgIHM)} & \multicolumn{2}{l}{U235 (\%)} & \multicolumn{2}{l}{Fissile Pu (\%)} & \multicolumn{2}{l}{Total Pu (\%)} \\
Batch & Value & \%Diff & Value & \%Diff & Value & \%Diff & Value & \%Diff \\
1 & 13.570 & 12.754 & 0.656 & 2.50 & 0.550 & 18.737 & 0.680 & 7.541 \\
2 & 22.040 & -7.628 & 0.723 & -4.868 & 0.641 & 6.919 & 0.835 & 2.189 \\
3 & 32.510 & 2.394 & 0.789 & -1.375 & 0.710 & 4.883 & 0.970 & 5.231 \\
4 & 31.230 & -2.406 & 0.851 & 0.117 & 0.680 & -2.254 & 0.906 & -5.031 \\
5 & 33.010 & 0.030 & 0.843 & -0.824 & 0.703 & 2.198 & 0.946 & 0.285 \\
Equal. & 33.020 & 0.060 & 0.855 & 0.588 & 0.700 & 1.833 & 0.951 & 0.820
\end{tabular}
\end{table}

Table 3 shows how XSGen/Bright-lite compares to the NEA results. The equilibrium results here show good agreement with this case. As Bright-lite is often used to derive output isotopics from used fuels to be passed onto recycle scenarios, accurately predicting the equilibrium output isotopics is important. 

The startup results however, show some discrepancies. The amount of plutonium generated within the first batch is significantly higher within Bright-lite compared to the NEA data. This trend only continues for the first two cycles. Due to the way Bright-lite operates, this is caused by the lower enriched batches within the startup core that do not have neutron poisons from fission products or other actinides. This means that there is a higher effective flux striking a high amount of U238 causing more generation of Pu239. The NEA benchmark has these low enrichment startup batches spread more evenly, Bright-lite has them all inside the inner most part of the circle. 

\begin{table}[]
\centering
\caption{NEA data for a 3.6\% enriched light water reactor start up behavior.}
\label{Table 4}
\begin{tabular}{lllll}
Batch & Burnup (MWd/kg) & U235 (\%) & Fissile Pu (\%) & Total Pu(\%) \\
1 & 13.9 & 0.840 & 0.474 & 0.629 \\
2 & 22.67 & 0.721 & 0.642 & 0.892 \\
3 & 32.36 & 0.647 & 0.716 & 1.039 \\
4 & 41.00 & 0.640 & 0.785 & 1.177 \\
5 & 39.00 & 0.940 & 0.808 & 1.166 \\
6 & 40.60 & 0.88 & 0.817 & 1.194 \\
Equil. & 42.50 & 0.81 & 0..827 & 1.223
\end{tabular}
\end{table}

\begin{table}[]
\centering
\caption{XSGen / Bright-lite data for the 3.6\% enriched light water reactor start up behavior.}
\label{Table 5}
\begin{tabular}{lllllllll}
 & \multicolumn{2}{l}{Burnup (MWd/kgIHM)} & \multicolumn{2}{l}{U235 (\%)} & \multicolumn{2}{l}{Fissile Pu (\%)} & \multicolumn{2}{l}{Total Pu (\%)} \\
Batch & Value & \%Diff & Value & \%Diff & Value & \%Diff & Value & \%Diff \\
1 & 13.37 & 3.84 & 0.930 & 10.77 & 0.62 & 30.43 & 0.78 & 23.53 \\
2 & 22.69 & 0.07 & 0.82 & 13.02 & 0.72 & 12.81 & 0.96 & 7.49 \\
3 & 32.38 & 0.03 & 0.72 & 11.08 & 0.78 & 8.46 & 1.07 & 2.69 \\
4 & 42.57 & 3.83 & 0.61 & 5.33 & 0.804 & 2.42 & 1.14 & 2.94 \\
5 & 41.00 & 5.13 & 0.85 & 9.526 & 0.79 & 2.81 & 1.10 & 5.91 \\
6 & 43.83 & 3.04 & 0.82 & 6.53 & 0.79 & 3.58 & 1.11 & 7.45 \\
7 & 42.48 & 0.06 & 0.80 & 1.11 & 0.79 & 4.47 & 1.11 & 9.11 \\
Equal. & 42.32 & 0.43 & 0.81 & 0.44 & 0.79 & 4.54 & 1.11 & 9.424
\end{tabular}
\end{table}

Table 4 and Table 5 are repeats of Table 2 and Table 3 for the 3.6$\%$ enriched light water reactor. Again, you see a similar trend in these two with the exception that the equilibrium results for the total amount of plutonium within the reactor is 9.2$\%$ lower in the Bright-lite model. The amount of fissile plutonium is also lower, but within acceptable bounds. The lower amount of fissile plutonium leads to less transmutations into the high order actinides. 

\section{MOX Case}
Simply replicating the behavior of a light water reactor would not show off the full capabilities of the XSGen software. To demonstrate the capability of the system to extend to more advanced reactor types, XSGen will be used to generate a MOX fuel library for Bright-lite. It will then be used to simulate a single pass MOX reactor. In order to compare this on an apples to apples basis, the input fuel into the Bright-lite reactor will be exactly the same as that for a similar VISION reactor. This test will be able to demonstrate the flexibility of the combined XSGen/Bright-lite system that allows it to model advanced reactor types. 




\end{document}

